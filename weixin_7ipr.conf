# 解决跨域
server {
  listen       80;
  server_name  weixin.7ipr.com;
  charset      utf-8;

  location / {
    proxy_pass 'http://localhost:8080';
  }

  location /api {

    proxy_pass 'http://weixin.7ipr.com/Repository/';

    add_header 'Access-Control-Allow-Origin' '*' always;
    add_header 'Access-Control-Allow-Credentials' true;
    add_header 'Access-Control-Allow-Methods' 'GET,POST,PUT,DELETE,OPTIONS';
    # add_header 'Access-Control-Allow-Headers' 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Contr$';

    if ($request_method = 'OPTIONS') {
        return 204;
      }
    }

  location /weixin {
    try_files $uri $uri/ /index.html;
  }
}
